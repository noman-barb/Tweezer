# Camera Module - Real-Time Particle Tracking System

High-performance image acquisition and particle tracking system with TrackPy integration, gRPC streaming, and HDF5 data storage. The system operates across two PCs connected via 10 Gigabit Ethernet for optimal performance.

## ğŸ“– Table of Contents

- [Architecture Overview](#architecture-overview)
- [Hardware Topology](#hardware-topology)
- [Tracking Pipeline](#tracking-pipeline)
- [Image Server](#image-server)
- [Image Watcher](#image-watcher)
- [Save Compressed Server](#save-compressed-server)
- [Data Storage](#data-storage)
- [Performance Optimization](#performance-optimization)
- [API Reference](#api-reference)

## ğŸ—ï¸ Architecture Overview

The Camera module operates in a **distributed architecture across two PCs**:

- **Camera PC**: Hamamatsu camera acquisition, RAMdisk storage, ImageWatcher, and save_compressed_server
- **Main Control PC**: ImageServer_with_track.py receives images via 10G LAN and performs TrackPy tracking

## ğŸ–§ Hardware Topology

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMERA MODULE HARDWARE TOPOLOGY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                         CAMERA PC                                          â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚  â”‚  Hamamatsu  â”‚                                                            â”‚
â”‚  â”‚  â”‚   Camera    â”‚ Connected directly to Camera PC                            â”‚
â”‚  â”‚  â”‚   Hardware  â”‚                                                            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚  â”‚         â”‚                                                                   â”‚
â”‚  â”‚         â–¼                                                                   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  â”‚          Hamamatsu Camera Software                             â”‚        â”‚
â”‚  â”‚  â”‚          (dumps images to RAMdisk)                             â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”‚                         â”‚                                                  â”‚
â”‚  â”‚                         â–¼                                                  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  â”‚                    RAMdisk (TIFF Storage)                      â”‚        â”‚
â”‚  â”‚  â”‚                                                                 â”‚        â”‚
â”‚  â”‚  â”‚  - Temporary high-speed storage                                â”‚        â”‚
â”‚  â”‚  â”‚  - TIFF images written by camera software                      â”‚        â”‚
â”‚  â”‚  â”‚  - Watched by ImageWatcher and save_compressed_server          â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”‚                   â”‚                        â”‚                               â”‚
â”‚  â”‚                   â–¼                        â–¼                               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  â”‚    ImageWatcher.py      â”‚    â”‚ save_compressed_server  â”‚               â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚        .py              â”‚               â”‚
â”‚  â”‚  â”‚ - Monitors RAMdisk      â”‚    â”‚                         â”‚               â”‚
â”‚  â”‚  â”‚ - Detects new TIFFs     â”‚    â”‚ - Monitors RAMdisk      â”‚               â”‚
â”‚  â”‚  â”‚ - Sends to Main PC      â”‚    â”‚ - Converts TIFFâ†’JPEG-XL â”‚               â”‚
â”‚  â”‚  â”‚ - gRPC streaming        â”‚    â”‚ - Lossless compression  â”‚               â”‚
â”‚  â”‚  â”‚   (10G LAN)             â”‚    â”‚ - Saves to permanent    â”‚               â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚   storage               â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚          â”‚                               â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                               â”‚                                â”‚
â”‚             â”‚ 10 Gigabit                    â–¼                                â”‚
â”‚             â”‚ Ethernet              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚             â”‚                       â”‚   Permanent     â”‚                      â”‚
â”‚             â”‚                       â”‚    Storage      â”‚                      â”‚
â”‚             â”‚                       â”‚  (JPEG-XL)      â”‚                      â”‚
â”‚             â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚             â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                      MAIN CONTROL PC                                      â”‚
â”‚  â”‚                                                                            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  â”‚         ImageServer_with_track.py (Port 50052)                 â”‚      â”‚
â”‚  â”‚  â”‚                                                                 â”‚      â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚  â”‚  â”‚   gRPC      â”‚    â”‚   Tile      â”‚    â”‚   TrackPy Engine   â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚   Server    â”‚â”€â”€â”€â–¶â”‚  Processing â”‚â”€â”€â”€â–¶â”‚   (32 processes)    â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚  256x256    â”‚    â”‚                     â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  Receives   â”‚    â”‚  +32px      â”‚    â”‚  - Particle detect  â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  images     â”‚    â”‚  overlap    â”‚    â”‚  - Sub-pixel track  â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  from       â”‚    â”‚             â”‚    â”‚  - Real-time        â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  Camera PC  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚      â”‚
â”‚  â”‚  â”‚         â”‚                                                       â”‚      â”‚
â”‚  â”‚  â”‚         â–¼                                                       â”‚      â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚      â”‚
â”‚  â”‚  â”‚  â”‚         Results distributed to:                     â”‚       â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  - Dashboard GUI (live display)                     â”‚       â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  - SLM control (feedback loop)                      â”‚       â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  - HDF5 storage (data logging)                      â”‚       â”‚      â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                                â”‚
â”‚  Data Flow Summary:                                                           â”‚
â”‚  1. Camera â†’ RAMdisk (TIFF) [Camera PC]                                       â”‚
â”‚  2. RAMdisk â†’ ImageWatcher â†’ Main PC Image Server (10G LAN)                   â”‚
â”‚  3. Image Server â†’ TrackPy â†’ Results to Dashboard/SLM [Main PC]               â”‚
â”‚  4. RAMdisk â†’ save_compressed_server â†’ Permanent Storage (JPEG-XL) [Camera PC]â”‚
â”‚                                                                                â”‚
â”‚  When dashboard "save" is pressed:                                            â”‚
â”‚  - Camera software starts dumping TIFFs to RAMdisk                            â”‚
â”‚  - ImageWatcher sends images to Main PC for tracking                          â”‚
â”‚  - save_compressed_server converts TIFFs to lossless JPEG-XL in background    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”¬ Component Details

### ImageWatcher.py (Camera PC)
**Location**: Runs on Camera PC
**Purpose**: Monitors RAMdisk for new TIFF files and streams them to Main PC

- Watches RAMdisk directory for new `.tif`/`.tiff` files
- Sends images via gRPC to ImageServer on Main PC (10G LAN)
- Handles network disconnections and reconnection
- Supports both polling and event-driven (watchdog) modes
- Can optionally delete images after successful upload

### ImageServer_with_track.py (Main Control PC)
**Location**: Runs on Main Control PC
**Purpose**: Receives images and performs real-time particle tracking

- gRPC server on port 50052
- Receives images from ImageWatcher (Camera PC)
- Tile-based TrackPy processing (32 processes)
- 256x256 tiles with 32px overlap
- Sub-pixel particle localization
- Results streamed to dashboard and SLM control

### save_compressed_server.py (Camera PC)
**Location**: Runs on Camera PC
**Purpose**: Converts TIFF images to lossless JPEG-XL for permanent storage

- Monitors same RAMdisk as ImageWatcher
- Converts TIFF â†’ JPEG-XL (lossless, high compression)
- Multi-process compression (16 workers)
- Quality 100, effort 7 for best lossless compression
- Saves to permanent storage location
- Runs continuously in background

The Camera module implements a multi-threaded, tile-based tracking architecture for high-performance particle detection:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMERA MODULE ARCHITECTURE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                        Client Layer                                        â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚  Dashboard  â”‚    â”‚   External  â”‚    â”‚    Direct   â”‚    â”‚   Image     â”‚  â”‚
â”‚  â”‚  â”‚  Monitor    â”‚    â”‚   Services  â”‚    â”‚   Python    â”‚    â”‚  Watcher    â”‚  â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚   Client    â”‚    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Live     â”‚ â”‚    â”‚ â”‚SLM      â”‚ â”‚    â”‚ â”‚Scripts  â”‚ â”‚    â”‚ â”‚File     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Display  â”‚ â”‚    â”‚ â”‚Feedback â”‚ â”‚    â”‚ â”‚Analysis â”‚ â”‚    â”‚ â”‚Monitor  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚          â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚         â”‚       gRPC Server (Port 50052)          â”‚                   â”‚     â”‚
â”‚  â”‚         â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                    ImageExchange Service                              â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Upload    â”‚    â”‚  Download   â”‚    â”‚     Configuration          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Image     â”‚    â”‚   Latest    â”‚    â”‚      Management            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚   Image     â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Receive  â”‚ â”‚    â”‚ â”‚Serve    â”‚ â”‚    â”‚ â”‚Storage  â”‚  â”‚Tracking â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Compress â”‚ â”‚    â”‚ â”‚Cache    â”‚ â”‚    â”‚ â”‚Config   â”‚  â”‚Params   â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Store    â”‚ â”‚    â”‚ â”‚Stream   â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚                                      â”‚                                     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                      Processing Pipeline                              â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Image     â”‚    â”‚    Tile     â”‚    â”‚      Tracking Engine       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Buffer    â”‚â”€â”€â”€â–¶â”‚  Splitter   â”‚â”€â”€â”€â–¶â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Ring     â”‚ â”‚    â”‚ â”‚256x256  â”‚ â”‚    â”‚ â”‚TrackPy  â”‚  â”‚Process  â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Buffer   â”‚ â”‚    â”‚ â”‚Overlap  â”‚ â”‚    â”‚ â”‚Batch    â”‚  â”‚Pool     â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Thread-  â”‚ â”‚    â”‚ â”‚32px     â”‚ â”‚    â”‚ â”‚Locate   â”‚  â”‚32 work- â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Safe     â”‚ â”‚    â”‚ â”‚Border   â”‚ â”‚    â”‚ â”‚Features â”‚  â”‚ers      â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â”‚                             â”‚                        â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Result    â”‚    â”‚   Feature   â”‚    â”‚      Data Aggregation      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Merger     â”‚â—€â”€â”€â”€â”‚  Filtering  â”‚â—€â”€â”€â”€â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚De-dup   â”‚ â”‚    â”‚ â”‚Mass     â”‚ â”‚    â”‚ â”‚Tile     â”‚  â”‚Position â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Border   â”‚ â”‚    â”‚ â”‚Eccent.  â”‚ â”‚    â”‚ â”‚Results  â”‚  â”‚Offset   â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Overlap  â”‚ â”‚    â”‚ â”‚Signal   â”‚ â”‚    â”‚ â”‚Queue    â”‚  â”‚Correct  â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                        Storage Layer                                       â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚    TIFF     â”‚    â”‚    HDF5     â”‚    â”‚   Memory    â”‚    â”‚    CSV      â”‚  â”‚
â”‚  â”‚  â”‚  Storage    â”‚    â”‚   Archive   â”‚    â”‚    Cache    â”‚    â”‚  Metadata   â”‚  â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Raw      â”‚ â”‚    â”‚ â”‚Compress â”‚ â”‚    â”‚ â”‚Latest   â”‚ â”‚    â”‚ â”‚Tracking â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Images   â”‚ â”‚    â”‚ â”‚Tracks   â”‚ â”‚    â”‚ â”‚Frame    â”‚ â”‚    â”‚ â”‚Results  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚16-bit   â”‚ â”‚    â”‚ â”‚Dataset  â”‚ â”‚    â”‚ â”‚Queue    â”‚ â”‚    â”‚ â”‚Export   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚LZW      â”‚ â”‚    â”‚ â”‚Zstd     â”‚ â”‚    â”‚ â”‚Thread-  â”‚ â”‚    â”‚ â”‚Format   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â”‚Safe     â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Sequence â”‚ â”‚    â”‚ â”‚Batch    â”‚ â”‚    â”‚ â”‚Display  â”‚ â”‚    â”‚ â”‚Position â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Number   â”‚ â”‚    â”‚ â”‚Write    â”‚ â”‚    â”‚ â”‚Buffer   â”‚ â”‚    â”‚ â”‚Mass     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Metadata â”‚ â”‚    â”‚ â”‚Groups   â”‚ â”‚    â”‚ â”‚Resize   â”‚ â”‚    â”‚ â”‚Stats    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”¬ Tracking Pipeline

The particle tracking system implements a sophisticated multi-stage pipeline optimized for real-time performance:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PARTICLE TRACKING PIPELINE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  Stage 1: Image Acquisition                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  Camera                 USB3/GigE              Memory                       â”‚
â”‚  â”‚  Sensor      â”€â”€â”€â”€â”€â”€â”€â”€â–¶  Transfer   â”€â”€â”€â”€â”€â”€â”€â”€â–¶   Buffer                       â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  â”‚ CMOS    â”‚          â”‚ 2048x   â”‚            â”‚ Ring    â”‚                   â”‚
â”‚  â”‚  â”‚ 2048x   â”‚  â”€â”€â”€â”€â”€â”€â–¶ â”‚ 2048    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ Buffer  â”‚                   â”‚
â”‚  â”‚  â”‚ 2048    â”‚          â”‚ 16-bit  â”‚            â”‚ 10 Frameâ”‚                   â”‚
â”‚  â”‚  â”‚ Mono    â”‚          â”‚ 200MB/s â”‚            â”‚ 80MB    â”‚                   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”‚                            â”‚                        â”‚                       â”‚
â”‚  â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         Timing: 5-10 ms/frame       â”‚                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚                                                         â–¼                   â”‚   â”‚
â”‚  Stage 2: Tile-Based Decomposition                                         â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  Full Frame           Tile Generation          Overlap Handling         â”‚   â”‚
â”‚  â”‚  (2048x2048)  â”€â”€â”€â”€â”€â”€â–¶ (256x256 tiles)  â”€â”€â”€â”€â”€â”€â–¶ (32px borders)          â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”¬â”€â”¬â”€â” â”‚          â”‚ Tile    â”‚            â”‚ Overlap â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ â”œâ”€â”¼â”€â”¼â”€â”¤ â”‚  â”€â”€â”€â”€â”€â”€â–¶ â”‚ (0,0)   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ Region  â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ â”œâ”€â”¼â”€â”¼â”€â”¤ â”‚          â”‚ 256x256 â”‚            â”‚ Track   â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ â””â”€â”´â”€â”´â”€â”˜ â”‚          â”‚ + 32px  â”‚            â”‚ De-dup  â”‚                â”‚   â”‚
â”‚  â”‚  â”‚64 tiles â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                     â”‚                    â”‚   â”‚
â”‚  â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚                         Timing: <1 ms               â”‚                â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚                                                         â–¼                â”‚   â”‚   â”‚
â”‚  Stage 3: Parallel Feature Detection (TrackPy)                          â”‚   â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  Process Pool (32 workers)                                              â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  Worker 1  â”‚  Worker 2  â”‚  Worker 3  â”‚  ...  â”‚ Worker 32               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚Tile   â”‚ â”‚  â”‚Tile   â”‚ â”‚  â”‚Tile   â”‚ â”‚       â”‚ â”‚Tile   â”‚                â”‚   â”‚
â”‚  â”‚  â”‚Locate â”‚ â”‚  â”‚Locate â”‚ â”‚  â”‚Locate â”‚ â”‚  ...  â”‚ â”‚Locate â”‚                â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ â”‚  â”‚       â”‚ â”‚  â”‚       â”‚ â”‚       â”‚ â”‚       â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”â”‚ â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”â”‚ â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”â”‚ â”‚       â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Band â”‚â”‚â”‚ â”‚  â”‚â”‚Band â”‚â”‚â”‚ â”‚  â”‚â”‚Band â”‚â”‚â”‚       â”‚ â”‚â”‚Band â”‚â”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Pass â”‚â”‚â”‚ â”‚  â”‚â”‚Pass â”‚â”‚â”‚ â”‚  â”‚â”‚Pass â”‚â”‚â”‚       â”‚ â”‚â”‚Pass â”‚â”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚       â”‚ â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Peak â”‚â”‚â”‚ â”‚  â”‚â”‚Peak â”‚â”‚â”‚ â”‚  â”‚â”‚Peak â”‚â”‚â”‚       â”‚ â”‚â”‚Peak â”‚â”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Find â”‚â”‚â”‚ â”‚  â”‚â”‚Find â”‚â”‚â”‚ â”‚  â”‚â”‚Find â”‚â”‚â”‚       â”‚ â”‚â”‚Find â”‚â”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚  â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚ â”‚       â”‚ â”‚â”œâ”€â”€â”€â”€â”€â”¤â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Refineâ”‚â”‚ â”‚  â”‚â”‚Refineâ”‚â”‚ â”‚  â”‚â”‚Refineâ”‚â”‚       â”‚ â”‚â”‚Refineâ”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â”‚Centerâ”‚â”‚ â”‚  â”‚â”‚Centerâ”‚â”‚ â”‚  â”‚â”‚Centerâ”‚â”‚       â”‚ â”‚â”‚Centerâ”‚â”‚                â”‚   â”‚
â”‚  â”‚  â”‚â””â”€â”€â”€â”€â”€â”˜â”‚ â”‚  â”‚â””â”€â”€â”€â”€â”€â”˜â”‚ â”‚  â”‚â””â”€â”€â”€â”€â”€â”˜â”‚ â”‚       â”‚ â”‚â””â”€â”€â”€â”€â”€â”˜â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚      â”‚          â”‚            â”‚                      â”‚                    â”‚   â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚                         Timing: 2-5 ms/tile         â”‚                â”‚   â”‚   â”‚
â”‚  â”‚                         Throughput: 100+ fps        â”‚                â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚                                                         â–¼                â”‚   â”‚   â”‚
â”‚  Stage 4: Result Aggregation & Filtering                                â”‚   â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  Merge Tiles         Filter Features        Output Format              â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚Position â”‚         â”‚Mass     â”‚           â”‚Position â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚Offset   â”‚  â”€â”€â”€â”€â”€â–¶ â”‚Filter   â”‚  â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚(x, y)   â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚Correct  â”‚         â”‚Min/Max  â”‚           â”‚Mass     â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚Eccent.  â”‚                  â”‚   â”‚
â”‚  â”‚                                             â”‚Size     â”‚                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚Signal   â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚Border   â”‚         â”‚Eccent.  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚  â”‚De-dup   â”‚  â”€â”€â”€â”€â”€â–¶ â”‚Filter   â”‚                â”‚                       â”‚   â”‚
â”‚  â”‚  â”‚32px     â”‚         â”‚Max 0.3  â”‚                â”‚                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                       â”‚   â”‚
â”‚  â”‚                                                  â–¼                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚Overlap  â”‚         â”‚Size     â”‚           â”‚Protobuf â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚Resolve  â”‚  â”€â”€â”€â”€â”€â–¶ â”‚Filter   â”‚  â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚Message  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚  â”‚  â”‚Match    â”‚         â”‚Diameter â”‚           â”‚Stream   â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                  â”‚                       â”‚   â”‚
â”‚  â”‚                         Timing: <1 ms            â”‚                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚                                                      â–¼                       â”‚   â”‚
â”‚  Stage 5: Data Distribution                                                â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚   gRPC      â”‚    â”‚   HDF5      â”‚    â”‚   Memory    â”‚    â”‚  Telemetry  â”‚  â”‚
â”‚  â”‚  â”‚  Clients    â”‚    â”‚  Storage    â”‚    â”‚   Cache     â”‚    â”‚   Stream    â”‚  â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ â”‚Dashboardâ”‚ â”‚    â”‚ â”‚Tracks   â”‚ â”‚    â”‚ â”‚Latest   â”‚ â”‚    â”‚ â”‚Position â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚SLM      â”‚ â”‚    â”‚ â”‚Images   â”‚ â”‚    â”‚ â”‚Results  â”‚ â”‚    â”‚ â”‚Count    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”‚External â”‚ â”‚    â”‚ â”‚Meta     â”‚ â”‚    â”‚ â”‚Display  â”‚ â”‚    â”‚ â”‚Timing   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  Total End-to-End Latency: 10-20 ms (Detection â†’ Output)                   â”‚
â”‚  â”‚  Throughput: 100+ frames/second with 1000+ particles/frame                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ–¥ï¸ Image Server

### Server Architecture

The ImageServer implements a multi-threaded architecture with process pooling for CPU-intensive tracking:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IMAGE SERVER INTERNAL ARCHITECTURE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                    gRPC Service Interface                                   â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚UploadImage  â”‚    â”‚GetLatest    â”‚    â”‚Configure    â”‚    â”‚GetMetrics   â”‚  â”‚
â”‚  â”‚  â”‚RPC          â”‚    â”‚ImageRPC     â”‚    â”‚StorageRPC   â”‚    â”‚RPC          â”‚  â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚Receives:    â”‚    â”‚Returns:     â”‚    â”‚Updates:     â”‚    â”‚Returns:     â”‚  â”‚
â”‚  â”‚  â”‚- ImageChunk â”‚    â”‚- Latest img â”‚    â”‚- Storage    â”‚    â”‚- Perf data  â”‚  â”‚
â”‚  â”‚  â”‚- Metadata   â”‚    â”‚- Timestamp  â”‚    â”‚- Tracking   â”‚    â”‚- Counters   â”‚  â”‚
â”‚  â”‚  â”‚- Sequence   â”‚    â”‚- Tracks     â”‚    â”‚- Paths      â”‚    â”‚- Timing     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚         â”‚                   â”‚                   â”‚                   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            â”‚                   â”‚                   â”‚                   â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚         â”‚           Image Management Thread              â”‚                 â”‚
â”‚  â”‚         â”‚                   â”‚                   â”‚                   â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                      Shared State (Thread-Safe)                       â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”‚Latest Image â”‚    â”‚Config State â”‚    â”‚     Performance Metrics     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚Cache        â”‚    â”‚             â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- ImageData  â”‚    â”‚- TileSize   â”‚    â”‚- FrameCount   - AvgTime     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- Tracks     â”‚    â”‚- Overlap    â”‚    â”‚- TrackCount   - PeakTime    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- Timestamp  â”‚    â”‚- Diameter   â”‚    â”‚- ProcessRate  - QueueDepth  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- Sequence   â”‚    â”‚- MinMass    â”‚    â”‚- ErrorCount   - WorkerUtil  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚threading.   â”‚    â”‚threading.   â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚Lock()       â”‚    â”‚RLock()      â”‚    â”‚atomic counters              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            â”‚                   â”‚                   â”‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚         â”‚         Worker Process Pool (32 processes)        â”‚               â”‚
â”‚  â”‚         â”‚                   â”‚                   â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚  Initialization (per-worker):                                         â”‚ â”‚
â”‚  â”‚  â”‚  - Import trackpy, numpy, numba                                       â”‚ â”‚
â”‚  â”‚  â”‚  - Set thread counts (OMP_NUM_THREADS=1)                              â”‚ â”‚
â”‚  â”‚  â”‚  - Compile numba JIT functions                                        â”‚ â”‚
â”‚  â”‚  â”‚  - Pin to specific CPU cores (optional)                               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚         â”‚                   â”‚                   â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                    Task Queue & Distribution                          â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  Incoming Image â”€â”€â–¶ Tile Generation â”€â”€â–¶ Task Queue â”€â”€â–¶ Process Pool   â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚  â”‚  â”‚  â”‚Image    â”‚ â”€â”€â”€â–¶ â”‚Split    â”‚ â”€â”€â”€â–¶ â”‚Queue    â”‚ â”€â”€â”€â–¶ â”‚Worker   â”‚      â”‚ â”‚
â”‚  â”‚  â”‚  â”‚Buffer   â”‚      â”‚64 tiles â”‚      â”‚64 tasks â”‚      â”‚Dispatch â”‚      â”‚ â”‚
â”‚  â”‚  â”‚  â”‚         â”‚      â”‚256x256  â”‚      â”‚         â”‚      â”‚         â”‚      â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
â”‚  â”‚  â”‚                                           â”‚                           â”‚ â”‚
â”‚  â”‚  â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚                   â”‚                       â–¼                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ Worker 1          â”‚ Worker 2            â”‚ Worker 32       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â”‚trackpy.locate â”‚ â”‚ â”‚trackpy.locate â”‚   â”‚ â”‚trackpy.     â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â”‚(tile_data,    â”‚ â”‚ â”‚(tile_data,    â”‚   â”‚ â”‚locate       â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â”‚ diameter=21,  â”‚ â”‚ â”‚ diameter=21,  â”‚   â”‚ â”‚(...)        â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â”‚ minmass=100)  â”‚ â”‚ â”‚ minmass=100)  â”‚   â”‚ â”‚             â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â”‚         â”‚         â”‚         â”‚           â”‚         â”‚       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â”‚                   â”‚                   â”‚                     â”‚         â”‚ â”‚
â”‚  â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚  â”‚  â”‚                                       â–¼                               â”‚ â”‚
â”‚  â”‚  â”‚                               Result Aggregation                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                      Storage Subsystem                                     â”‚
â”‚  â”‚                                       â”‚                                     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                 Parallel Storage Writers                              â”‚ â”‚
â”‚  â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ TIFF Writer â”‚    â”‚ HDF5 Writer â”‚    â”‚      CSV Writer            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Thread      â”‚    â”‚ Thread      â”‚    â”‚      Thread                â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- tifffile   â”‚    â”‚- h5py       â”‚    â”‚- Track positions            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- LZW comp   â”‚    â”‚- Zstd comp  â”‚    â”‚- Metadata export            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- 16-bit     â”‚    â”‚- Batching   â”‚    â”‚- Analysis ready             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚- Sequence   â”‚    â”‚- Chunked    â”‚    â”‚                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tracking Configuration

The tracking engine uses optimized TrackPy parameters:

```python
# Default configuration for particle detection
tracking_config = {
    "diameter": 21,          # Feature size in pixels (odd number)
    "separation": 18,        # Minimum separation between features
    "minmass": 100.0,        # Minimum integrated brightness
    "maxmass": 0.0,          # Maximum mass (0 = no limit)
    "percentile": 14.0,      # Background percentile for bandpass
    "tile_width": 256,       # Tile width for parallel processing
    "tile_height": 256,      # Tile height
    "tile_overlap": 32,      # Overlap border for edge handling
    "max_ecc": 0.3,          # Maximum eccentricity (circularity)
}
```

## ğŸ“Š GUI Dashboard

The Camera module includes a comprehensive monitoring GUI built with DearPyGUI:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CAMERA GUI DASHBOARD                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  Image Display Window                  â”‚  Control Panel                    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚                                  â”‚  â”‚  â”‚  Server Connection          â”‚  â”‚
â”‚  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚                          â”‚   â”‚  â”‚  â”‚  â”‚Host: localhost        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   Live Camera Feed       â”‚   â”‚  â”‚  â”‚  â”‚Port: 50052            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   1024 x 1024           â”‚   â”‚  â”‚  â”‚  â”‚Status: â—Connected     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚                          â”‚   â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â€¢ â€¢ â€¢   â—‹ â€¢ â€¢          â”‚   â”‚  â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ â—‹ â€¢   â€¢ â€¢ â—‹           â”‚   â”‚  â”‚  â”‚  Storage Configuration     â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â—‹ â€¢ â€¢   â€¢ â—‹ â€¢          â”‚   â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ â€¢ â—‹   â—‹ â€¢ â€¢           â”‚   â”‚  â”‚  â”‚  â”‚Path: ./data/          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚                          â”‚   â”‚  â”‚  â”‚  â”‚Format: [x] TIFF       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚ Particles: 127           â”‚   â”‚  â”‚  â”‚  â”‚        [x] HDF5       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚ FPS: 98.3                â”‚   â”‚  â”‚  â”‚  â”‚        [x] CSV        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚                          â”‚   â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â”‚                                  â”‚  â”‚  â”‚  Tracking Parameters       â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Zoom: [====|====] 1.0x    â”‚  â”‚  â”‚  â”‚  â”‚Diameter:  21         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Brightness: [=======|=] 0.8â”‚  â”‚  â”‚  â”‚  â”‚Separation: 18        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Contrast: [====|====] 1.0 â”‚  â”‚  â”‚  â”‚  â”‚MinMass: 100.0        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ [Overlay Tracks] [â—]      â”‚  â”‚  â”‚  â”‚  â”‚MaxEcc: 0.30          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â”‚ [Apply Changes]      â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  Performance Metrics                    â”‚  Track Statistics               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚  Frame Rate                      â”‚  â”‚  â”‚  Detection Results          â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚     â–„â–„â–„â–„                   â”‚  â”‚  â”‚  â”‚  â”‚Particles: 127         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–„                â”‚  â”‚  â”‚  â”‚  â”‚Avg Mass: 1523.4       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              â”‚  â”‚  â”‚  â”‚  â”‚Avg Ecc: 0.12          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„             â”‚  â”‚  â”‚  â”‚  â”‚Avg Size: 3.8          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚  â”‚  â”‚  â”‚  â”‚                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ 0  20  40  60  80  100 fps â”‚  â”‚  â”‚  â”‚  â”‚Position Distribution: â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â”‚ X: [-512, 512]        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                  â”‚  â”‚  â”‚  â”‚ Y: [-512, 512]        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Processing Time                 â”‚  â”‚  â”‚  â”‚ StdDev: (Â±15, Â±12)    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Acquisition:  5.2 ms â–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Tracking:     3.8 ms â–ˆâ–ˆâ–ˆ    â”‚  â”‚  â”‚  â”‚  Export Controls           â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Storage:      1.1 ms â–ˆ      â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Network:      0.8 ms â–Œ      â”‚  â”‚  â”‚  â”‚  â”‚[Export Tracks (CSV)]  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Total:       10.9 ms â–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â”‚  â”‚  â”‚[Save Image Stack]     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â”‚[Clear Cache]          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  Log Window                                                                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”‚ [INFO] 2025-10-31 14:32:15 - Server connected successfully           â”‚   â”‚
â”‚  â”‚  â”‚ [INFO] 2025-10-31 14:32:16 - Tracking engine initialized (32 workers)â”‚   â”‚
â”‚  â”‚  â”‚ [INFO] 2025-10-31 14:32:17 - Frame 1523: 127 particles detected      â”‚   â”‚
â”‚  â”‚  â”‚ [INFO] 2025-10-31 14:32:17 - Processing time: 10.9ms, FPS: 98.3     â”‚   â”‚
â”‚  â”‚  â”‚ [INFO] 2025-10-31 14:32:18 - HDF5 batch write: 100 frames stored    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¾ Data Storage

The system implements a sophisticated multi-format storage strategy:

### Storage Formats

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA STORAGE ARCHITECTURE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  TIFF Image Storage (Raw Data)                                             â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  Format: Multi-page TIFF with LZW compression                              â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”‚ File Structure:                                                      â”‚   â”‚
â”‚  â”‚  â”‚   data/                                                              â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ YYYY-MM-DD/                                                    â”‚   â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ run_001_frame_000000.tiff    (2048x2048, 16-bit)          â”‚   â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ run_001_frame_000001.tiff    Compression: LZW ~50% ratio  â”‚   â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ run_001_frame_000002.tiff    Size: ~4 MB/frame           â”‚   â”‚
â”‚  â”‚  â”‚       â””â”€â”€ ...                          Metadata: TIFF tags          â”‚   â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”‚ Metadata Tags:                                                       â”‚   â”‚
â”‚  â”‚  â”‚   - ImageDescription: JSON metadata                                 â”‚   â”‚
â”‚  â”‚  â”‚   - DateTime: ISO 8601 timestamp                                    â”‚   â”‚
â”‚  â”‚  â”‚   - Software: "TweezerCamera v1.0"                                  â”‚   â”‚
â”‚  â”‚  â”‚   - PixelSize: Calibrated um/pixel                                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  HDF5 Archive Storage (Processed Data)                                     â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  Format: Hierarchical Data Format with Zstd compression                    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”‚ File Structure:                                                      â”‚   â”‚
â”‚  â”‚  â”‚   data/                                                              â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ YYYY-MM-DD/                                                    â”‚   â”‚
â”‚  â”‚  â”‚       â””â”€â”€ tracking_run_001.h5                                        â”‚   â”‚
â”‚  â”‚  â”‚           â”œâ”€â”€ /images/                  (Dataset, chunked)          â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”œâ”€â”€ frame_000000          Shape: (2048, 2048)         â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”œâ”€â”€ frame_000001          Dtype: uint16               â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â””â”€â”€ ...                   Compression: zstd level 3   â”‚   â”‚
â”‚  â”‚  â”‚           â”‚                                                          â”‚   â”‚
â”‚  â”‚  â”‚           â”œâ”€â”€ /tracks/                  (Dataset)                   â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”œâ”€â”€ frame_000000          Columns: x, y, mass, ecc    â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - x: [float32]        Size, signal                â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - y: [float32]        ~1KB per frame              â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - mass: [float32]                                 â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - ecc: [float32]                                  â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - size: [float32]                                 â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â”‚   - signal: [float32]                               â”‚   â”‚
â”‚  â”‚  â”‚           â”‚   â””â”€â”€ ...                                               â”‚   â”‚
â”‚  â”‚  â”‚           â”‚                                                          â”‚   â”‚
â”‚  â”‚  â”‚           â””â”€â”€ /metadata/                (Attributes)                â”‚   â”‚
â”‚  â”‚  â”‚               â”œâ”€â”€ acquisition_params                                â”‚   â”‚
â”‚  â”‚  â”‚               â”œâ”€â”€ tracking_config                                   â”‚   â”‚
â”‚  â”‚  â”‚               â”œâ”€â”€ system_info                                       â”‚   â”‚
â”‚  â”‚  â”‚               â””â”€â”€ processing_metrics                                â”‚   â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”‚ Compression: Zstd level 3 (~70% ratio)                              â”‚   â”‚
â”‚  â”‚  â”‚ Chunking: (1, 2048, 2048) for images, (100, N) for tracks          â”‚   â”‚
â”‚  â”‚  â”‚ Total Size: ~30 GB per 10,000 frames                                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚  CSV Export (Analysis-Ready)                                               â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”‚  Format: Comma-separated values for direct analysis                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”‚ File: tracks_run_001.csv                                             â”‚   â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”‚ frame, particle_id, x, y, mass, ecc, size, signal, timestamp        â”‚   â”‚
â”‚  â”‚  â”‚ 0, 0, 512.34, 1023.12, 1523.4, 0.12, 3.8, 450.2, 1698761537.123    â”‚   â”‚
â”‚  â”‚  â”‚ 0, 1, 623.45, 987.65, 1432.1, 0.15, 3.6, 423.1, 1698761537.123     â”‚   â”‚
â”‚  â”‚  â”‚ 1, 0, 512.41, 1023.08, 1519.2, 0.13, 3.7, 448.9, 1698761537.133    â”‚   â”‚
â”‚  â”‚  â”‚ ...                                                                  â”‚   â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”‚ Compatible with: pandas, MATLAB, Excel, R                            â”‚   â”‚
â”‚  â”‚  â”‚ Size: ~100 bytes per particle per frame                             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš¡ Performance Optimization

### CPU Affinity and Thread Management

```python
# Set CPU affinity for tracking workers (service_config.yaml)
image_server:
  cpu_list: "2-37"              # Reserve CPUs 2-37 for tracking
  tracker_processes: 32         # Number of worker processes
  
# Per-worker thread limitation
os.environ["OMP_NUM_THREADS"] = "1"
os.environ["MKL_NUM_THREADS"] = "1"
os.environ["NUMBA_NUM_THREADS"] = "1"
```

### Memory Management

```python
# Ring buffer for image storage
ring_buffer_size = 10  # Keep last 10 frames in memory
cache_size_mb = 80     # ~8MB per frame * 10 frames

# HDF5 batch writing for efficiency
hdf5_batch_size = 100  # Write every 100 frames
chunk_cache_mb = 128   # HDF5 chunk cache size
```

### Performance Benchmarks

```
Hardware: Intel i7-12700K, 32GB RAM, RTX 4070
Image Size: 2048x2048, 16-bit
Particle Count: ~1000 per frame

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PERFORMANCE BENCHMARKS                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Single-Threaded (1 worker):                               â”‚
â”‚  - Processing Time: 180-220 ms/frame                       â”‚
â”‚  - Throughput: 4-5 fps                                     â”‚
â”‚  - CPU Usage: 6-8%                                         â”‚
â”‚                                                             â”‚
â”‚  Multi-Process (8 workers):                                â”‚
â”‚  - Processing Time: 25-35 ms/frame                         â”‚
â”‚  - Throughput: 28-40 fps                                   â”‚
â”‚  - CPU Usage: 45-60%                                       â”‚
â”‚                                                             â”‚
â”‚  Optimized (32 workers):                                   â”‚
â”‚  - Processing Time: 10-15 ms/frame                         â”‚
â”‚  - Throughput: 65-100 fps                                  â”‚
â”‚  - CPU Usage: 80-95%                                       â”‚
â”‚  - Memory Usage: 2-4 GB (workers + buffers)                â”‚
â”‚                                                             â”‚
â”‚  Bottlenecks:                                              â”‚
â”‚  - Image Acquisition: ~5 ms (camera limited)               â”‚
â”‚  - Feature Detection: ~8 ms (parallelizable)               â”‚
â”‚  - Result Aggregation: ~1 ms (minimal)                     â”‚
â”‚  - Storage I/O: ~2 ms (async writes)                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ API Reference

### gRPC Service Definition

```protobuf
syntax = "proto3";
package images;

// Image upload message
message ImageChunk {
  string filename = 1;
  int64 timestamp_ms = 2;
  bytes data = 3;
  string source = 4;
  int64 sequence = 5;
}

// Upload acknowledgment
message UploadAck {
  bool ok = 1;
  string message = 2;
}

// Latest image response with tracks
message LatestImageReply {
  bool has_image = 1;
  string filename = 2;
  int64 timestamp_ms = 3;
  string source = 4;
  bytes data = 5;
  int64 sequence = 6;
  repeated TrackDetectionProto tracks = 7;
}

// Particle track information
message TrackDetectionProto {
  double x = 1;
  double y = 2;
  double mass = 3;
  double ecc = 4;
  double size = 5;
  double signal = 6;
}

// Service definition
service ImageExchange {
  rpc UploadImage(ImageChunk) returns (UploadAck);
  rpc GetLatestImage(LatestImageRequest) returns (LatestImageReply);
  rpc ConfigureStorage(StorageConfig) returns (google.protobuf.Empty);
}
```

### Python Client API

```python
from Camera.main_gui import ImageClient
import numpy as np

# Initialize client
client = ImageClient("localhost:50052")

# Upload image
image_data = np.random.randint(0, 65535, (2048, 2048), dtype=np.uint16)
success = client.upload_image(image_data, source="experiment_1")

# Get latest image with tracks
latest = client.get_latest_image()
if latest.has_image:
    image = np.frombuffer(latest.data, dtype=np.uint16)
    image = image.reshape(latest.height, latest.width)
    tracks = [(t.x, t.y, t.mass) for t in latest.tracks]
    print(f"Found {len(tracks)} particles")

# Configure tracking parameters
config = {
    "diameter": 21,
    "minmass": 150.0,
    "separation": 20,
}
client.configure_tracking(config)
```

## ğŸš€ Quick Start

### Starting the Image Server

```bash
# Activate environment
conda activate tweezer

# Start server with default configuration
python Camera/ImageServer_with_track.py \
    --host 0.0.0.0 \
    --port 50052 \
    --tracker-processes 32 \
    --tile-width 256 \
    --track-diameter 21

# Or use service manager
python GUI/service_manager.py
```

### Launching the GUI

```bash
python Camera/main_gui.py --server localhost:50052
```

### File Monitoring

```bash
# Watch a directory for new images
python Camera/ImageWatcher.py \
    --watch-dir ./incoming_images \
    --server localhost:50052
```

## ğŸ› Troubleshooting

**Low Frame Rate**
- Increase number of worker processes
- Reduce image size or tile size
- Check CPU affinity settings
- Monitor disk I/O performance

**Memory Issues**
- Reduce ring buffer size
- Decrease HDF5 batch size
- Lower worker process count
- Check for memory leaks in long-running sessions

**Tracking Accuracy**
- Adjust diameter parameter (must be odd)
- Tune minmass threshold for your SNR
- Modify percentile for background subtraction
- Check max_ecc for non-circular features

**Storage Problems**
- Verify disk space availability
- Check file permissions
- Monitor I/O wait times
- Consider SSD for better performance

## ğŸ“„ File Structure

```
Camera/
â”œâ”€â”€ ImageServer_with_track.py   # Main tracking server
â”œâ”€â”€ main_gui.py                 # DearPyGUI dashboard
â”œâ”€â”€ ImageWatcher.py             # Directory monitoring
â”œâ”€â”€ image_proto.py              # Protobuf message definitions
â”œâ”€â”€ image_exchange_pb2.py       # Generated protobuf
â”œâ”€â”€ image_exchange_pb2_grpc.py  # Generated gRPC stubs
â”œâ”€â”€ proto/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ image_exchange.proto    # Protocol buffer schema
â””â”€â”€ README.md                   # This documentation
```

This Camera module provides the foundation for high-performance real-time particle tracking in optical tweezer experiments, enabling closed-loop feedback control with minimal latency.